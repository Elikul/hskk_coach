<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HSKK Coach - –¢—Ä–µ–Ω–∞–∂–µ—Ä –∫–∏—Ç–∞–π—Å–∫–æ–≥–æ —è–∑—ã–∫–∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            max-width: 800px;
            width: 100%;
            padding: 40px;
            text-align: center;
        }

        h1 {
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5rem;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .level-selection {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .level-btn {
            padding: 20px;
            border: 2px solid #667eea;
            background: white;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.2rem;
            font-weight: bold;
            color: #667eea;
        }

        .level-btn:hover {
            background: #667eea;
            color: white;
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .level-btn.selected {
            background: #667eea;
            color: white;
        }

        .exercise-container {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .exercise-container.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .text-display {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            border-left: 5px solid #667eea;
        }

        .chinese-text {
            font-size: 1.8rem;
            color: #333;
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .pinyin-text {
            font-size: 1.2rem;
            color: #666;
            font-style: italic;
            margin-bottom: 20px;
        }

        .audio-controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .audio-btn {
            padding: 15px 30px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .audio-btn:hover {
            background: #5a67d8;
            transform: scale(1.05);
        }

        .audio-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: scale(1);
        }

        .recording-section {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .record-btn {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: 3px solid #e74c3c;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 2rem;
        }

        .record-btn:hover {
            background: #e74c3c;
            color: white;
            transform: scale(1.1);
        }

        .record-btn.recording {
            background: #e74c3c;
            color: white;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(231, 76, 60, 0.7); }
            70% { box-shadow: 0 0 0 20px rgba(231, 76, 60, 0); }
            100% { box-shadow: 0 0 0 0 rgba(231, 76, 60, 0); }
        }

        .recording-status {
            font-size: 1.1rem;
            color: #666;
            margin-bottom: 20px;
        }

        .audio-visualizer {
            height: 60px;
            background: #e9ecef;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .visualizer-bar {
            width: 4px;
            background: #667eea;
            margin: 0 2px;
            border-radius: 2px;
            transition: height 0.1s ease;
        }

        .next-btn {
            padding: 15px 40px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }

        .next-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .hidden {
            display: none;
        }

        .results-section {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            animation: fadeIn 0.5s ease;
        }

        .results-section h3 {
            color: #333;
            margin-bottom: 25px;
            font-size: 1.5rem;
        }

        .score-display {
            text-align: center;
            margin-bottom: 30px;
        }

        .score-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            position: relative;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .score-circle span {
            color: white;
            font-size: 2rem;
            font-weight: bold;
        }

        .score-display p {
            color: #666;
            font-size: 1.1rem;
        }

        .syllable-analysis {
            margin-bottom: 30px;
        }

        .syllable-analysis h4 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .syllable-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 15px;
            margin-bottom: 8px;
            border-radius: 8px;
            background: white;
            border-left: 4px solid #ddd;
        }

        .syllable-item.correct {
            border-left-color: #28a745;
            background: #d4edda;
        }

        .syllable-item.incorrect {
            border-left-color: #dc3545;
            background: #f8d7da;
        }

        .syllable-text {
            font-weight: bold;
            color: #333;
        }

        .syllable-status {
            font-size: 0.9rem;
            padding: 4px 8px;
            border-radius: 4px;
            color: white;
        }

        .syllable-status.correct {
            background: #28a745;
        }

        .syllable-status.incorrect {
            background: #dc3545;
        }

        .chart-container {
            margin-bottom: 30px;
            height: 200px;
            background: white;
            border-radius: 10px;
            padding: 15px;
        }

        .reference-audio h4 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .reference-audio audio {
            width: 100%;
            max-width: 400px;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 10px;
            color: white;
            font-weight: bold;
            z-index: 1000;
            max-width: 300px;
            animation: slideIn 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .notification.error {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .notification.warning {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }

        .notification.success {
            background: linear-gradient(135deg, #27ae60, #229954);
        }

        .notification.info {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .server-status {
            position: fixed;
            top: 20px;
            left: 20px;
            padding: 10px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
            z-index: 999;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .server-status.online {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .server-status.offline {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .server-status.online .status-indicator {
            background: #28a745;
        }

        .server-status.offline .status-indicator {
            background: #dc3545;
        }

        @media (max-width: 768px) {
            .notification {
                right: 10px;
                top: 10px;
                max-width: 250px;
                font-size: 0.9rem;
            }

            .server-status {
                left: 10px;
                top: 10px;
                font-size: 0.8rem;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
                margin: 10px;
            }

            h1 {
                font-size: 2rem;
            }

            .chinese-text {
                font-size: 1.5rem;
            }

            .pinyin-text {
                font-size: 1rem;
            }

            .level-selection {
                grid-template-columns: 1fr;
            }

            .audio-controls {
                flex-direction: column;
                align-items: center;
            }

            .audio-btn {
                width: 100%;
                max-width: 250px;
                justify-content: center;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 15px;
            }

            h1 {
                font-size: 1.8rem;
            }

            .chinese-text {
                font-size: 1.3rem;
            }

            .text-display {
                padding: 20px;
            }

            .recording-section {
                padding: 20px;
            }
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div id="serverStatus" class="server-status offline">
        <div class="status-indicator"></div>
        <span id="statusText">–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞...</span>
    </div>

    <div id="notificationContainer"></div>

    <div class="container">
        <h1>HSKK Coach</h1>
        
        <div id="levelSelection" class="level-selection">
            <button class="level-btn" data-level="1_2">HSKK 1-2</button>
            <button class="level-btn" data-level="3_4">HSKK 3-4</button>
            <button class="level-btn" data-level="5_6">HSKK 5-6</button>
        </div>

        <div id="exerciseContainer" class="exercise-container">
            <div class="text-display">
                <div class="chinese-text" id="chineseText"></div>
                <div class="pinyin-text" id="pinyinText"></div>
            </div>

            <div class="audio-controls">
                <button id="playBtn" class="audio-btn">
                    <span>üîä</span>
                    <span>–ü—Ä–æ—Å–ª—É—à–∞—Ç—å</span>
                </button>
                <button id="pauseBtn" class="audio-btn hidden">
                    <span>‚è∏Ô∏è</span>
                    <span>–ü–∞—É–∑–∞</span>
                </button>
            </div>

            <div class="recording-section">
                <div class="recording-status" id="recordingStatus">
                    –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –∑–∞–ø–∏—Å—å –≤–∞—à–µ–≥–æ –æ—Ç–≤–µ—Ç–∞
                </div>
                
                <div class="audio-visualizer" id="visualizer">
                    <div class="visualizer-bar" style="height: 20px;"></div>
                    <div class="visualizer-bar" style="height: 30px;"></div>
                    <div class="visualizer-bar" style="height: 25px;"></div>
                    <div class="visualizer-bar" style="height: 35px;"></div>
                    <div class="visualizer-bar" style="height: 28px;"></div>
                    <div class="visualizer-bar" style="height: 32px;"></div>
                    <div class="visualizer-bar" style="height: 22px;"></div>
                    <div class="visualizer-bar" style="height: 38px;"></div>
                    <div class="visualizer-bar" style="height: 26px;"></div>
                    <div class="visualizer-bar" style="height: 30px;"></div>
                </div>

                <button id="recordBtn" class="record-btn">
                    üé§
                </button>

                <div id="recordedAudio" class="hidden">
                    <audio id="userAudio" controls></audio>
                    <button id="analyzeBtn" class="audio-btn" style="margin-top: 15px;">
                        <span>üîç</span>
                        <span>–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–µ—á—å</span>
                    </button>
                </div>
            </div>

            <div id="resultsSection" class="results-section hidden">
                <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞</h3>
                
                <div class="score-display">
                    <div class="score-circle">
                        <span id="scorePercentage">0%</span>
                    </div>
                    <p>–¢–æ—á–Ω–æ—Å—Ç—å –ø—Ä–æ–∏–∑–Ω–æ—à–µ–Ω–∏—è</p>
                </div>

                <div class="syllable-analysis">
                    <h4>–ê–Ω–∞–ª–∏–∑ —Å–ª–æ–≥–æ–≤</h4>
                    <div id="syllableResults"></div>
                </div>

                <div class="chart-container">
                    <canvas id="accuracyChart"></canvas>
                </div>

                <div class="reference-audio">
                    <h4>–≠—Ç–∞–ª–æ–Ω–Ω–æ–µ –ø—Ä–æ–∏–∑–Ω–æ—à–µ–Ω–∏–µ</h4>
                    <audio id="referenceAudio" controls></audio>
                </div>
            </div>

            <button id="nextBtn" class="next-btn">–°–ª–µ–¥—É—é—â–µ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ</button>
        </div>
    </div>

    <script>
        class HSKKCoach {
            constructor() {
                this.currentLevel = null;
                this.currentExercise = null;
                this.audioContext = null;
                this.mediaRecorder = null;
                this.audioChunks = [];
                this.isRecording = false;
                this.currentAudio = null;
                this.exercises = this.loadExercises();
                this.serverAvailable = false;
                
                this.initializeElements();
                this.attachEventListeners();
                this.checkServerStatus();
                this.startServerStatusCheck();
            }

            loadExercises() {
                const exercises = {
                    '1_2': [
                        { text: 'ÊàëÂè´ÂÆâÂ®úÔºåÊàëÊù•Ëá™‰øÑÁΩóÊñØ', pinyin: 'w«í ji√†o ƒÅn n√† Ôºåw«í l√°i z√¨ √© lu√≥ sƒ´', audio: 'generation_dataset/WAV/1_2/hskk_1_1_f.wav' },
                        { text: 'ÊàëÊØèÂ§©‰∏ÉÁÇπËµ∑Â∫ä', pinyin: 'w«í mƒõi tiƒÅn qƒ´ di«én q«ê chu√°ng', audio: 'generation_dataset/WAV/1_2/hskk_1_2_f.wav' },
                        { text: 'ÊàëÂñúÊ¨¢ÂêÉÈ•∫Â≠êÂíåÁ±≥È•≠', pinyin: 'w«í x«ê huƒÅn chƒ´ ji«éo zi h√© m«ê f√†n', audio: 'generation_dataset/WAV/1_2/hskk_1_3_f.wav' },
                        { text: '‰ªäÂ§©Â§©Ê∞îÂæàÂ•ΩÔºå‰∏çÂÜ∑‰πü‰∏çÁÉ≠', pinyin: 'jƒ´n tiƒÅn tiƒÅn q√¨ hƒõn h«éo Ôºåb√π lƒõng yƒõ b√π r√®', audio: 'generation_dataset/WAV/1_2/hskk_1_4_f.wav' },
                        { text: 'ÊàëÂú®Â≠¶Ê†°Â≠¶‰∏≠Êñá', pinyin: 'w«í z√†i xu√© xi√†o xu√© zh≈çng w√©n', audio: 'generation_dataset/WAV/1_2/hskk_1_5_f.wav' }
                    ],
                    '3_4': [
                        { text: 'ËôΩÁÑ∂Â≠¶‰∏≠ÊñáÂæàÈöæÔºå‰ΩÜÊòØÊàëÊØèÂ§©ÈÉΩÂùöÊåÅÁªÉ‰π†', pinyin: 'suƒ´ r√°n xu√© zh≈çng w√©n hƒõn n√°n Ôºåd√†n sh√¨ w«í mƒõi tiƒÅn d≈´ jiƒÅn ch√≠ li√†n x√≠', audio: 'generation_dataset/WAV/3_4/hsk_3_1_f.wav' },
                        { text: 'ÊàëËßâÂæóÂ≠¶ËØ≠Ë®ÄÊúÄÈáçË¶ÅÁöÑÊòØÊï¢ÂºÄÂè£ËØ¥ËØù', pinyin: 'w«í ju√© de xu√© y«î y√°n zu√¨ zh√≤ng y√†o de sh√¨ g«én kƒÅi k«íu shu≈ç hu√†', audio: 'generation_dataset/WAV/3_4/hsk_3_2_f.wav' },
                        { text: '‰∏ä‰∏™ÊúàÊàëÂéªÂåó‰∫¨ÊóÖË°å‰∫ÜÔºåÂèÇËßÇ‰∫ÜÊïÖÂÆ´ÂíåÈïøÂüé', pinyin: 'sh√†ng ge yu√® w«í q√π bƒõi jƒ´ng l«ö x√≠ng le ÔºåcƒÅn guƒÅn le g√π g≈çng h√© ch√°ng ch√©ng', audio: 'generation_dataset/WAV/3_4/hsk_3_3_f.wav' },
                        { text: 'Â¶ÇÊûúÊàëÊúâÊõ¥Â§öÊó∂Èó¥ÔºåÊàëÊÉ≥Â§öËØª‰∏Ä‰∫õ‰∏≠ÊñáÂ∞èËØ¥', pinyin: 'r√∫ gu«í w«í y«íu g√®ng du≈ç sh√≠ jiƒÅn Ôºåw«í xi«éng du≈ç d√∫ yƒ´ xiƒì zh≈çng w√©n xi«éo shu≈ç', audio: 'generation_dataset/WAV/3_4/hsk_3_4_f.wav' },
                        { text: 'Áé∞Âú®Ë∂äÊù•Ë∂äÂ§öÁöÑÂ§ñÂõΩ‰∫∫ÂºÄÂßãÂ≠¶‰π†‰∏≠Êñá', pinyin: 'xi√†n z√†i yu√® l√°i yu√® du≈ç de w√†i gu√≥ r√©n kƒÅi sh«ê xu√© x√≠ zh≈çng w√©n', audio: 'generation_dataset/WAV/3_4/hsk_3_5_f.wav' }
                    ],
                    '5_6': [
                        { text: 'ÈöèÁùÄ‰∫∫Â∑•Êô∫ËÉΩÁöÑÂèëÂ±ïÔºåÊú™Êù•ÁöÑÂ∑•‰ΩúÊ®°ÂºèÂèØËÉΩ‰ºöÂèëÁîüÊ†πÊú¨ÊÄßÂèòÂåñ', pinyin: 'su√≠ zhe r√©n g≈çng zh√¨ n√©ng de fƒÅ zh«én Ôºåw√®i l√°i de g≈çng zu√≤ m√≥ sh√¨ kƒõ n√©ng hu√¨ fƒÅ shƒìng gƒìn bƒõn x√¨ng bi√†n hu√†', audio: 'generation_dataset/WAV/5_6/hsk_5_1_f.wav' },
                        { text: '‰º†ÁªüÊñáÂåñÁöÑ‰º†Êâø‰∏éÁé∞‰ª£Âåñ‰πãÈó¥ÈúÄË¶ÅÊâæÂà∞‰∏Ä‰∏™Âπ≥Ë°°ÁÇπ', pinyin: 'chu√°n t«íng w√©n hu√† de chu√°n ch√©ng y«î xi√†n d√†i hu√† zhƒ´ jiƒÅn x≈´ y√†o zh«éo d√†o y√≠ g√® p√≠ng h√©ng di«én', audio: 'generation_dataset/WAV/5_6/hsk_5_2_f.wav' },
                        { text: 'ÊïôËÇ≤‰∏çÂ∫îÂè™ÂÖ≥Ê≥®ËÄÉËØïÊàêÁª©ÔºåËÄåÂ∫îÊ≥®ÈáçÂüπÂÖªÂ≠¶ÁîüÁöÑÊâπÂà§ÊÄßÊÄùÁª¥', pinyin: 'ji√†o y√π b√π yƒ´ng zhƒ´ guƒÅn zh√π k«éo sh√¨ ch√©ng jƒ´ Ôºå√©r yƒ´ng zh√π zh√≤ng p√©i y«éng xu√© shƒìng de pƒ´ p√†n x√¨ng sƒ´ w√©i', audio: 'generation_dataset/WAV/5_6/hsk_5_3_f.wav' },
                        { text: 'ÂÖ®ÁêÉÂåñËôΩÁÑ∂‰øÉËøõ‰∫ÜÊñáÂåñ‰∫§ÊµÅÔºå‰ΩÜ‰πüÂèØËÉΩÂØºËá¥Êüê‰∫õÊú¨ÂúüÊñáÂåñÁöÑÊ∂àÂ§±', pinyin: 'qu√°n qi√∫ hu√† suƒ´ r√°n c√π j√¨n le w√©n hu√† jiƒÅo li√∫ Ôºåd√†n yƒõ kƒõ n√©ng d«éo zh√¨ m«íu xiƒì bƒõn t«î w√©n hu√† de xiƒÅo shƒ´', audio: 'generation_dataset/WAV/5_6/hsk_5_4_f.wav' },
                        { text: 'ÊàëËÆ§‰∏∫ÁúüÊ≠£ÁöÑËØ≠Ë®ÄËÉΩÂäõ‰∏ç‰ªÖ‰ΩìÁé∞Âú®ËØçÊ±áÈáè‰∏äÔºåÊõ¥‰ΩìÁé∞Âú®ËØ≠Áî®ÂíåÊñáÂåñÁêÜËß£‰∏ä', pinyin: 'w«í r√®n w√©i zhƒìn zh√®ng de y«î y√°n n√©ng l√¨ b√π j«ên t«ê xi√†n z√†i c√≠ hu√¨ li√†ng sh√†ng Ôºåg√®ng t«ê xi√†n z√†i y«î y√≤ng h√© w√©n hu√† l«ê jiƒõ sh√†ng', audio: 'generation_dataset/WAV/5_6/hsk_5_5_f.wav' }
                    ]
                };
                return exercises;
            }

            initializeElements() {
                this.levelButtons = document.querySelectorAll('.level-btn');
                this.exerciseContainer = document.getElementById('exerciseContainer');
                this.chineseText = document.getElementById('chineseText');
                this.pinyinText = document.getElementById('pinyinText');
                this.playBtn = document.getElementById('playBtn');
                this.pauseBtn = document.getElementById('pauseBtn');
                this.recordBtn = document.getElementById('recordBtn');
                this.recordingStatus = document.getElementById('recordingStatus');
                this.nextBtn = document.getElementById('nextBtn');
                this.visualizer = document.getElementById('visualizer');
                this.userAudio = document.getElementById('userAudio');
                this.recordedAudio = document.getElementById('recordedAudio');
                this.analyzeBtn = document.getElementById('analyzeBtn');
                this.resultsSection = document.getElementById('resultsSection');
                this.scorePercentage = document.getElementById('scorePercentage');
                this.syllableResults = document.getElementById('syllableResults');
                this.referenceAudio = document.getElementById('referenceAudio');
            }

            attachEventListeners() {
                this.levelButtons.forEach(btn => {
                    btn.addEventListener('click', () => this.selectLevel(btn.dataset.level));
                });

                this.playBtn.addEventListener('click', () => this.playAudio());
                this.pauseBtn.addEventListener('click', () => this.pauseAudio());
                this.recordBtn.addEventListener('click', () => this.toggleRecording());
                this.analyzeBtn.addEventListener('click', () => this.analyzeSpeech());
                this.nextBtn.addEventListener('click', () => this.loadNextExercise());
            }

            showNotification(message, type = 'info', duration = 5000) {
                const notification = document.createElement('div');
                notification.className = `notification ${type}`;
                notification.textContent = message;
                
                const container = document.getElementById('notificationContainer');
                container.appendChild(notification);
                
                setTimeout(() => {
                    notification.style.animation = 'slideIn 0.3s ease reverse';
                    setTimeout(() => {
                        container.removeChild(notification);
                    }, 300);
                }, duration);
            }

            updateServerStatus(isOnline) {
                const statusElement = document.getElementById('serverStatus');
                const statusText = document.getElementById('statusText');
                
                this.serverAvailable = isOnline;
                
                if (isOnline) {
                    statusElement.className = 'server-status online';
                    statusText.textContent = '–°–µ—Ä–≤–µ—Ä –æ–Ω–ª–∞–π–Ω';
                } else {
                    statusElement.className = 'server-status offline';
                    statusText.textContent = '–°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω';
                }
            }

            async checkServerStatus() {
                try {
                    const response = await fetch('http://localhost:8000/', {
                        method: 'GET',
                        mode: 'no-cors',
                        cache: 'no-cache'
                    });
                    
                    // –ï—Å–ª–∏ –Ω–µ—Ç –æ—à–∏–±–∫–∏ CORS, —Å—á–∏—Ç–∞–µ–º —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω
                    this.updateServerStatus(true);
                    if (!this.serverAvailable) {
                        this.showNotification('–°–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω', 'success', 3000);
                    }
                } catch (error) {
                    this.updateServerStatus(false);
                    this.showNotification('–°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–≥—É—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å.', 'warning', 5000);
                }
            }

            startServerStatusCheck() {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
                setInterval(() => {
                    this.checkServerStatus();
                }, 10000);
            }

            async selectLevel(level) {
                this.currentLevel = level;
                
                this.levelButtons.forEach(btn => {
                    btn.classList.remove('selected');
                });
                event.target.classList.add('selected');

                // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –¥–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ —É—Ä–æ–≤–Ω—è
                try {
                    this.showNotification('–ü–æ–ª—É—á–∞–µ–º –¥–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É...', 'info');
                    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º stream –¥–ª—è –±—É–¥—É—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
                    this.audioStream = stream;
                    this.showNotification('–ú–∏–∫—Ä–æ—Ñ–æ–Ω –ø–æ–¥–∫–ª—é—á–µ–Ω!', 'success');
                    
                    // –ó–∞–∫—Ä—ã–≤–∞–µ–º stream –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
                    stream.getTracks().forEach(track => track.stop());
                } catch (error) {
                    this.showNotification('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É', 'error');
                    return;
                }

                document.getElementById('levelSelection').style.display = 'none';
                this.exerciseContainer.classList.add('active');
                
                this.loadNextExercise();
            }

            loadNextExercise() {
                const exercises = this.exercises[this.currentLevel];
                const randomIndex = Math.floor(Math.random() * exercises.length);
                this.currentExercise = exercises[randomIndex];

                this.chineseText.textContent = this.currentExercise.text;
                this.pinyinText.textContent = this.currentExercise.pinyin;

                // –û—á–∏—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
                this.clearResults();

                this.recordedAudio.classList.add('hidden');
                this.stopRecording();

                setTimeout(() => {
                    this.playAudio();
                }, 500);
            }

            async playAudio() {
                if (this.currentAudio) {
                    this.currentAudio.pause();
                }

                this.currentAudio = new Audio(this.currentExercise.audio);
                this.playBtn.classList.add('hidden');
                this.pauseBtn.classList.remove('hidden');

                this.currentAudio.addEventListener('ended', () => {
                    this.playBtn.classList.remove('hidden');
                    this.pauseBtn.classList.add('hidden');
                });

                this.currentAudio.addEventListener('error', () => {
                    this.showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∞—É–¥–∏–æ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª—ã.', 'error');
                    this.playBtn.classList.remove('hidden');
                    this.pauseBtn.classList.add('hidden');
                });

                try {
                    await this.currentAudio.play();
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∞—É–¥–∏–æ:', error);
                    this.showNotification('–ù–µ —É–¥–∞–ª–æ—Å—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –∞—É–¥–∏–æ', 'error');
                    this.playBtn.classList.remove('hidden');
                    this.pauseBtn.classList.add('hidden');
                }
            }

            pauseAudio() {
                if (this.currentAudio) {
                    this.currentAudio.pause();
                    this.playBtn.classList.remove('hidden');
                    this.pauseBtn.classList.add('hidden');
                }
            }

            async toggleRecording() {
                if (this.isRecording) {
                    this.stopRecording();
                } else {
                    await this.startRecording();
                }
            }

            async startRecording() {
                try {
                    // –ü–æ–ª—É—á–∞–µ–º –¥–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É (—Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ —É–∂–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø–æ–ª—É—á–µ–Ω–æ)
                    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                    
                    // –ò—Å–ø–æ–ª—å–∑—É–µ–º WebM —Ñ–æ—Ä–º–∞—Ç (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ–º –±—Ä–∞—É–∑–µ—Ä–æ–≤)
                    let options = { mimeType: 'audio/webm' };

                    
                    this.mediaRecorder = new MediaRecorder(stream, options);
                    this.audioChunks = [];
                    
                    console.log(`MediaRecorder –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω —Å –æ–ø—Ü–∏—è–º–∏:`, options);

                    this.mediaRecorder.addEventListener('dataavailable', (event) => {
                        this.audioChunks.push(event.data);
                    });

                    this.mediaRecorder.addEventListener('stop', () => {
                        // –ò—Å–ø–æ–ª—å–∑—É–µ–º MIME —Ç–∏–ø –∏–∑ MediaRecorder
                        let mimeType = this.mediaRecorder.mimeType || 'audio/webm';
                        
                        const audioBlob = new Blob(this.audioChunks, { type: mimeType });
                        const audioUrl = URL.createObjectURL(audioBlob);
                        this.userAudio.src = audioUrl;
                        this.recordedAudio.classList.remove('hidden');
                        
                        // –°–æ—Ö—Ä–∞–Ω—è–µ–º blob –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
                        this.recordedAudioBlob = audioBlob;
                        this.recordedAudioMimeType = mimeType;
                        
                        console.log(`–ê—É–¥–∏–æ –∑–∞–ø–∏—Å–∞–Ω–æ –≤ —Ñ–æ—Ä–º–∞—Ç–µ: ${mimeType}, —Ä–∞–∑–º–µ—Ä: ${audioBlob.size} –±–∞–π—Ç`);
                        
                        stream.getTracks().forEach(track => track.stop());
                    });

                    this.mediaRecorder.start();
                    this.isRecording = true;
                    this.recordBtn.classList.add('recording');
                    this.recordingStatus.textContent = '–ò–¥—ë—Ç –∑–∞–ø–∏—Å—å... –ù–∞–∂–º–∏—Ç–µ –µ—â—ë —Ä–∞–∑, —á—Ç–æ–±—ã –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å';
                    
                    this.startVisualizer();
                    this.showNotification('–ó–∞–ø–∏—Å—å –Ω–∞—á–∞—Ç–∞', 'info', 2000);
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É:', error);
                    
                    let errorMessage = '–û—à–∏–±–∫–∞: –Ω–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É';
                    if (error.name === 'NotAllowedError') {
                        errorMessage = '–î–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É –∑–∞–ø—Ä–µ—â–µ–Ω. –†–∞–∑—Ä–µ—à–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –±—Ä–∞—É–∑–µ—Ä–∞.';
                    } else if (error.name === 'NotFoundError') {
                        errorMessage = '–ú–∏–∫—Ä–æ—Ñ–æ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –º–∏–∫—Ä–æ—Ñ–æ–Ω –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.';
                    }
                    
                    this.recordingStatus.textContent = errorMessage;
                    this.showNotification(errorMessage, 'error');
                }
            }

            stopRecording() {
                if (this.mediaRecorder && this.isRecording) {
                    this.mediaRecorder.stop();
                    this.isRecording = false;
                    this.recordBtn.classList.remove('recording');
                    this.recordingStatus.textContent = '–ó–∞–ø–∏—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –ü—Ä–æ—Å–ª—É—à–∞–π—Ç–µ –≤–∞—à –æ—Ç–≤–µ—Ç –Ω–∏–∂–µ';
                    this.stopVisualizer();
                    this.showNotification('–ó–∞–ø–∏—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∞', 'success', 2000);
                }
            }

            startVisualizer() {
                if (!this.audioContext) {
                    this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                }

                const bars = this.visualizer.querySelectorAll('.visualizer-bar');
                this.visualizerInterval = setInterval(() => {
                    bars.forEach(bar => {
                        const height = Math.random() * 40 + 10;
                        bar.style.height = `${height}px`;
                    });
                }, 100);
            }

            stopVisualizer() {
                if (this.visualizerInterval) {
                    clearInterval(this.visualizerInterval);
                }
                
                const bars = this.visualizer.querySelectorAll('.visualizer-bar');
                bars.forEach(bar => {
                    bar.style.height = '20px';
                });
            }

            async analyzeSpeech() {
                if (!this.recordedAudioBlob) {
                    this.showNotification('–°–Ω–∞—á–∞–ª–∞ –∑–∞–ø–∏—à–∏—Ç–µ –≤–∞—à –æ—Ç–≤–µ—Ç', 'warning');
                    return;
                }

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞
                if (!this.serverAvailable) {
                    this.showNotification('–°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∞–Ω–∞–ª–∏–∑ —Ä–µ—á–∏.', 'error');
                    return;
                }

                this.analyzeBtn.innerHTML = '<span class="loading"></span><span>–ê–Ω–∞–ª–∏–∑...</span>';
                this.analyzeBtn.disabled = true;

try {
                    const formData = new FormData();
                    
                    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ - –≤ –æ—Å–Ω–æ–≤–Ω–æ–º WebM
                    let fileExtension = 'webm'; // –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                    if (this.recordedAudioMimeType) {
                        if (this.recordedAudioMimeType.includes('webm')) {
                            fileExtension = 'webm';
                        } else if (this.recordedAudioMimeType.includes('wav')) {
                            fileExtension = 'wav';
                        } else if (this.recordedAudioMimeType.includes('mp3')) {
                            fileExtension = 'mp3';
                        } else {
                            // –ï—Å–ª–∏ –ø—Ä–∏—à–µ–ª –¥—Ä—É–≥–æ–π —Ñ–æ—Ä–º–∞—Ç, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–∞–∫ webm
                            fileExtension = 'webm';
                            console.warn(`–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç ${this.recordedAudioMimeType}, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–∞–∫ webm`);
                        }
                    }
                    
                    const fileName = `user_recording.${fileExtension}`;
                    formData.append('audio', this.recordedAudioBlob, fileName);
                    formData.append('text', this.currentExercise.text);
                    formData.append('pinyin', this.currentExercise.pinyin);
                    
                    console.log(`–û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–∞: ${fileName}, MIME —Ç–∏–ø: ${this.recordedAudioMimeType}`);

                    const response = await fetch('http://localhost:8000/analyze', {
                        method: 'POST',
                        body: formData
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }

                    const result = await response.json();
                    
                    if (result.error) {
                        throw new Error(result.error);
                    }

                    this.displayResults(result);
                    this.showNotification('–ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!', 'success');

                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞:', error);
                    
                    let errorMessage = '–û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.';
                    
                    if (error.name === 'TypeError' && error.message.includes('Failed to fetch')) {
                        errorMessage = '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω.';
                    } else if (error.message.includes('timeout')) {
                        errorMessage = '–ü—Ä–µ–≤—ã—à–µ–Ω–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.';
                    } else if (error.message.includes('HTTP 404')) {
                        errorMessage = '–°–µ—Ä–≤–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞.';
                    } else if (error.message.includes('HTTP 500')) {
                        errorMessage = '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.';
                    }
                    
                    this.showNotification(errorMessage, 'error');
                    this.recordingStatus.textContent = errorMessage;
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ
                    this.updateServerStatus(false);
                    
                } finally {
                    this.analyzeBtn.innerHTML = '<span>üîç</span><span>–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–µ—á—å</span>';
                    this.analyzeBtn.disabled = false;
                }
            }

            clearResults() {
                // –°–∫—Ä—ã–≤–∞–µ–º —Å–µ–∫—Ü–∏—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
                this.resultsSection.classList.add('hidden');
                
                // –û—á–∏—â–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
                this.scorePercentage.textContent = '0%';
                this.syllableResults.innerHTML = '';
                this.chartContainer.innerHTML = '';
                
                // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —ç—Ç–∞–ª–æ–Ω–Ω–æ–µ –∞—É–¥–∏–æ –µ—Å–ª–∏ –∏–≥—Ä–∞–µ—Ç
                if (this.referenceAudio) {
                    this.referenceAudio.pause();
                    this.referenceAudio.currentTime = 0;
                }
            }

            displayResults(result) {
                this.resultsSection.classList.remove('hidden');
                
                // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç —Ç–æ—á–Ω–æ—Å—Ç–∏
                this.scorePercentage.textContent = `${result.accuracy}%`;
                
                // –ê–Ω–∏–º–∏—Ä—É–µ–º —Å—á–µ—Ç—á–∏–∫
                this.animateScore(result.accuracy);
                
                // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∞–Ω–∞–ª–∏–∑ —Å–ª–æ–≥–æ–≤
                this.displaySyllableAnalysis(result.syllables);
                
                // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –≥—Ä–∞—Ñ–∏–∫
                this.displayChart(result.chart_data);
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —ç—Ç–∞–ª–æ–Ω–Ω–æ–µ –∞—É–¥–∏–æ
                this.referenceAudio.src = this.currentExercise.audio;
                
                // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º
                this.resultsSection.scrollIntoView({ behavior: 'smooth' });
            }

            animateScore(targetScore) {
                let currentScore = 0;
                const increment = targetScore / 50;
                const timer = setInterval(() => {
                    currentScore += increment;
                    if (currentScore >= targetScore) {
                        currentScore = targetScore;
                        clearInterval(timer);
                    }
                    this.scorePercentage.textContent = `${Math.round(currentScore)}%`;
                }, 20);
            }

            displaySyllableAnalysis(syllables) {
                this.syllableResults.innerHTML = '';
                
                syllables.forEach(syllable => {
                    const syllableItem = document.createElement('div');
                    syllableItem.className = `syllable-item ${syllable.correct ? 'correct' : 'incorrect'}`;
                    
                    syllableItem.innerHTML = `
                        <div>
                            <span class="syllable-text">${syllable.user_syllable}</span>
                            ${!syllable.correct ? `<span style="margin-left: 10px; color: #666;">‚Üí ${syllable.correct_syllable}</span>` : ''}
                        </div>
                        <span class="syllable-status ${syllable.correct ? 'correct' : 'incorrect'}">
                            ${syllable.correct ? '‚úì –í–µ—Ä–Ω–æ' : '‚úó –ù–µ–≤–µ—Ä–Ω–æ'}
                        </span>
                    `;
                    
                    this.syllableResults.appendChild(syllableItem);
                });
            }

            displayChart(chartData) {
                const canvas = document.getElementById('accuracyChart');
                const ctx = canvas.getContext('2d');
                
                // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π –≥—Ä–∞—Ñ–∏–∫
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã canvas
                canvas.width = canvas.offsetWidth;
                canvas.height = canvas.offsetHeight;
                
                const data = chartData.values;
                const labels = chartData.labels;
                const maxValue = Math.max(...data);
                const padding = 40;
                const chartWidth = canvas.width - padding * 2;
                const chartHeight = canvas.height - padding * 2;
                
                // –†–∏—Å—É–µ–º –æ—Å–∏
                ctx.strokeStyle = '#ddd';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(padding, padding);
                ctx.lineTo(padding, canvas.height - padding);
                ctx.lineTo(canvas.width - padding, canvas.height - padding);
                ctx.stroke();
                
                // –†–∏—Å—É–µ–º —Å—Ç–æ–ª–±—Ü—ã
                const barWidth = chartWidth / data.length * 0.6;
                const barSpacing = chartWidth / data.length;
                
                data.forEach((value, index) => {
                    const barHeight = (value / maxValue) * chartHeight;
                    const x = padding + barSpacing * index + (barSpacing - barWidth) / 2;
                    const y = canvas.height - padding - barHeight;
                    
                    // –ì—Ä–∞–¥–∏–µ–Ω—Ç –¥–ª—è —Å—Ç–æ–ª–±—Ü–æ–≤
                    const gradient = ctx.createLinearGradient(0, y, 0, canvas.height - padding);
                    gradient.addColorStop(0, '#667eea');
                    gradient.addColorStop(1, '#764ba2');
                    
                    ctx.fillStyle = gradient;
                    ctx.fillRect(x, y, barWidth, barHeight);
                    
                    // –ü–æ–¥–ø–∏—Å–∏
                    ctx.fillStyle = '#666';
                    ctx.font = '12px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText(labels[index], x + barWidth / 2, canvas.height - padding + 20);
                    
                    // –ó–Ω–∞—á–µ–Ω–∏—è
                    ctx.fillText(`${value}%`, x + barWidth / 2, y - 5);
                });
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            new HSKKCoach();
        });
    </script>
</body>
</html>